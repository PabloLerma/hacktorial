!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var n=t();for(var r in n)("object"==typeof exports?exports:e)[r]=n[r]}}(window,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}n.r(t),n.d(t,"Hacktorial",(function(){return c}));var a=[{clock_in:"9:00",clock_out:"13:00"},{clock_in:"14:00",clock_out:"18:00"}],c=function(){function e(t,n,r){var o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.clock=this.setClock(o),this.year=t||(new Date).getUTCFullYear(),this.month=n||(new Date).getMonth()+1,this.holidays=a,this.employee_id=r}var t,n,c;return t=e,(n=[{key:"build",value:function(){return regeneratorRuntime.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(this.getPeriod());case 2:return e.abrupt("return",this);case 3:case"end":return e.stop()}}),null,this)}},{key:"help",value:function(){console.log("================================HELP================================"),console.log("Usage:"),console.log("let hacktorial = new Hacktorial(year, month, employee_id, clock);"),console.log("await hacktorial.build()"),console.log("await hacktorial.run()"),console.log("Arguments:"),console.log("[OPTIONAL] Year  [Integer] e.g. 2019                 DEFAULT => current year"),console.log("[OPTIONAL] Month [Integer] e.g. 11 (November)        DEFAULT => current month"),console.log("EmployeeID [Integer] e.g. 123456"),console.log("[OPTIONAL] Your schedule [Array of Hash]             DEFAULT =>"),console.log(a),console.log("[OPTIONAL] Holidays  [Array of Integers] e.g. [4, 5] DEFAULT => null"),console.log("Functions:"),console.log("await run()\t - Post your shifts"),console.log("await clean()\t - Clean your shifts"),console.log("=====================================================================")}},{key:"run",value:function(){return regeneratorRuntime.async((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.period_id){e.next=4;break}return console.log("Wait, period id not set!"),console.log("Check month: ".concat(this.month," and year: ").concat(this.year,".")),e.abrupt("return");case 4:return e.next=6,regeneratorRuntime.awrap(this.setWeekdaysInMonth());case 6:case"end":return e.stop()}}),null,this)}},{key:"clean",value:function(){return regeneratorRuntime.async((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,regeneratorRuntime.awrap(this.removeShifts());case 2:case"end":return e.stop()}}),null,this)}},{key:"setClock",value:function(e){if(!e)return a;if("object"!==r(e))throw Error("Clock format must be an object e.g. "+a);if(void 0===e.length||0==e.length)throw Error("Clock format must be a valid object e.g. "+a);e.forEach((function(e){console.log("clock_in: "+e.clock_in),console.log("clock_out: "+e.clock_out)})),this.clock=e}},{key:"getPeriod",value:function(){var e,t,n=this;return regeneratorRuntime.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,regeneratorRuntime.awrap(fetch("https://api.factorialhr.com/attendance/periods?year=".concat(this.year,"&month=").concat(this.month),{method:"GET",credentials:"include"}));case 2:return e=r.sent,r.next=5,regeneratorRuntime.awrap(e.text());case 5:t=r.sent,JSON.parse(t).forEach((function(e){e.employee_id==n.employee_id&&e.month==n.month&&e.year==n.year&&("pending"==e.state||"in_progress"==e.state?n.period_id=e.id:console.log("Hey! You cannot update this month, period is: ".concat(e.state)))}));case 8:case"end":return r.stop()}}),null,this)}},{key:"setWeekdaysInMonth",value:function(){var e,t,n,r,o,a,c,i,s,u,l;return regeneratorRuntime.async((function(f){for(;;)switch(f.prev=f.next){case 0:e=(new Date).getMonth()+1===this.month,t=(new Date).getDate(),n=new Date(this.year,this.month,0).getDate(),r=e?t:n,o=1;case 5:if(!(o<=r)){f.next=37;break}if(!this.isWeekday(o)){f.next=34;break}a=!0,c=!1,i=void 0,f.prev=10,s=this.clock[Symbol.iterator]();case 12:if(a=(u=s.next()).done){f.next=20;break}if(l=u.value,this.holidays.includes(o)){f.next=17;break}return f.next=17,regeneratorRuntime.awrap(this.sendData(o,l.clock_in,l.clock_out));case 17:a=!0,f.next=12;break;case 20:f.next=26;break;case 22:f.prev=22,f.t0=f.catch(10),c=!0,i=f.t0;case 26:f.prev=26,f.prev=27,a||null==s.return||s.return();case 29:if(f.prev=29,!c){f.next=32;break}throw i;case 32:return f.finish(29);case 33:return f.finish(26);case 34:o++,f.next=5;break;case 37:case"end":return f.stop()}}),null,this,[[10,22,26,34],[27,,29,33]])}},{key:"isWeekday",value:function(e){var t=new Date(this.year,this.month-1,e).getDay();return 6!=t&&0!=t}},{key:"sendData",value:function(e,t,n){var r;return regeneratorRuntime.async((function(o){for(;;)switch(o.prev=o.next){case 0:return r={clock_in:t,clock_out:n,day:e,history:[],minutes:0,observations:null,period_id:this.period_id},o.next=3,regeneratorRuntime.awrap(this.sendPost(r));case 3:case"end":return o.stop()}}),null,this)}},{key:"sendPost",value:function(e){var t,n;return regeneratorRuntime.async((function(r){for(;;)switch(r.prev=r.next){case 0:return r.next=2,regeneratorRuntime.awrap(fetch("https://api.factorialhr.com/attendance/shifts",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}));case 2:return t=r.sent,r.next=5,regeneratorRuntime.awrap(t.text());case 5:n=r.sent,console.log("POST:Â { day: ".concat(e.day,", month: ").concat(this.month,", year: ").concat(this.year,", time: { clock_in: ").concat(e.clock_in,", clock_out: ").concat(e.clock_out," }}")),console.log(n);case 8:case"end":return r.stop()}}),null,this)}},{key:"removeShifts",value:function(){var e,t,n,r,o,a,c,i,s;return regeneratorRuntime.async((function(u){for(;;)switch(u.prev=u.next){case 0:return u.next=2,regeneratorRuntime.awrap(fetch("https://api.factorialhr.com/attendance/shifts",{method:"GET",credentials:"include"}));case 2:e=u.sent,t=e.text(),n=JSON.parse(t),r=!0,o=!1,a=void 0,u.prev=8,c=n[Symbol.iterator]();case 10:if(r=(i=c.next()).done){u.next=19;break}if((s=i.value).period_id!=this.period_id){u.next=16;break}return console.log("DELETE: ".concat(s)),u.next=16,regeneratorRuntime.awrap(fetch("https://api.factorialhr.com/attendance/shifts/".concat(s.id),{method:"DELETE",credentials:"include"}));case 16:r=!0,u.next=10;break;case 19:u.next=25;break;case 21:u.prev=21,u.t0=u.catch(8),o=!0,a=u.t0;case 25:u.prev=25,u.prev=26,r||null==c.return||c.return();case 28:if(u.prev=28,!o){u.next=31;break}throw a;case 31:return u.finish(28);case 32:return u.finish(25);case 33:case"end":return u.stop()}}),null,this,[[8,21,25,33],[26,,28,32]])}}])&&o(t.prototype,n),c&&o(t,c),e}()}])}));